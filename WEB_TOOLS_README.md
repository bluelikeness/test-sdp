# 🌐 웹 기반 영역 선택 도구

OpenCV GUI 문제로 인해 웹 기반 버전을 제작했습니다.

## 🚀 빠른 시작

```bash
# WSL에서 실행
cd /home/kckang/work/test-sdp
python3 run_web_tools.py
```

## 📋 선택 가능한 도구

### 1. 웹 영역 선택만
- 브라우저에서 영역 선택
- 이미지 크롭 및 저장
- 포트: http://localhost:5000

### 2. 웹 영역 선택 + OCR 통합
- 영역 선택 + 자동 OCR 처리
- 텍스트 추출 및 결과 저장
- 포트: http://localhost:5001

## 🖱️ 웹 UI 사용법

### 기본 조작
1. **영역 선택**: 마우스로 드래그하여 사각형 그리기
2. **영역 크롭**: "영역 크롭" 버튼 클릭
3. **OCR 처리**: "OCR 실행" 버튼 클릭 (통합 버전)
4. **통합 처리**: "크롭 + OCR" 버튼으로 한 번에 처리
5. **영역 삭제**: "모든 영역 삭제" 버튼

### 단축키
- 여러 영역 선택 가능
- 실시간 영역 미리보기
- 처리 상태 표시

## 📁 출력 파일 위치

```
output/cropped_regions/
├── 이미지명_영역명_타임스탬프.png     # 크롭된 이미지
├── 이미지명_web_ocr_results_타임스탬프.txt  # OCR 결과
└── 이미지명_regions_타임스탬프.json    # 영역 정보
```

## 🔧 기술 스택

- **Backend**: Flask (Python)
- **Frontend**: HTML5 Canvas + JavaScript
- **OCR**: Qwen Cloud API
- **이미지 처리**: PIL, OpenCV

## 📦 필요한 의존성

```bash
pip install flask pillow opencv-python numpy python-dotenv
```

## ⚙️ 환경 설정

`.env` 파일에 API 키 설정:
```
QWEN_API_KEY=your_actual_api_key_here
```

## 🔍 문제 해결

### 브라우저가 자동으로 열리지 않는 경우
수동으로 접속:
- 영역 선택만: http://localhost:5000
- 영역 선택 + OCR: http://localhost:5001

### 포트 충돌 오류
다른 포트 사용:
```python
app.run(host='localhost', port=5002)  # 포트 변경
```

### API 키 오류
`.env` 파일에서 `QWEN_API_KEY` 확인

### Flask 모듈 없음
```bash
pip install flask
```

## 💡 사용 팁

### 효과적인 영역 선택
1. **적당한 여백 포함**: 텍스트 주변에 여백을 포함해서 선택
2. **너무 작게 선택 금지**: 최소 50×50px 이상 권장
3. **겹치는 영역 피하기**: 영역들이 겹치지 않도록 주의
4. **명확한 경계**: 텍스트가 잘리지 않도록 충분히 선택

### OCR 정확도 향상
1. **원형 내부 텍스트 우선**: 원형/타원형 안의 텍스트에 최적화됨
2. **고화질 이미지**: 가능한 한 고해상도 이미지 사용
3. **적절한 조명**: 밝고 균일한 조명의 이미지
4. **정확한 각도**: 기울어지지 않은 정면 이미지

## 🔄 워크플로우 예시

### 시나리오 1: 빠른 처리
1. `run_web_tools.py` 실행
2. "2. 웹 영역 선택 + OCR 통합" 선택
3. 브라우저에서 관심 영역들 드래그 선택
4. "크롭 + OCR" 버튼 클릭
5. `output/cropped_regions/` 폴더에서 결과 확인

### 시나리오 2: 단계별 처리
1. 영역 선택만 도구로 정확한 영역 설정
2. 영역 정보를 JSON으로 저장
3. OCR 통합 도구로 텍스트 추출
4. 결과 비교 및 최적화

## 🆚 기존 도구들과 비교

| 도구 | 장점 | 단점 | 사용 상황 |
|------|------|------|----------|
| **웹 UI** | 정확한 선택, 크로스 플랫폼 | 브라우저 필요 | WSL, GUI 문제 |
| OpenCV UI | 빠른 반응 | 환경 의존성 | GUI 정상 작동 시 |
| 자동 그리드 | 완전 자동화 | 불필요 영역 포함 | 대량 처리 |
| AI 위치 분석 | 지능적 판단 | 분석 오류 가능 | 복잡한 이미지 |

## 🎯 최적 사용 사례

- ✅ WSL 환경에서 GUI 문제 해결
- ✅ 정확한 영역 지정이 필요한 경우
- ✅ 여러 사용자가 웹으로 접근
- ✅ 실시간 결과 확인 필요
- ✅ 브라우저 기반 도구 선호

---

**🔗 관련 파일들:**
- `web_region_selector.py` - 웹 영역 선택 도구
- `web_region_ocr_integrated.py` - 웹 OCR 통합 도구
- `run_web_tools.py` - 실행기
- `UI_USAGE_GUIDE.md` - 전체 사용법 가이드
